version: "1.0"

# Databases
databases:
    - analytics:
        shared: no

    - raw:
        shared: no

    - snowflake:
        shared: yes

    - testing_db:
        shared: no


# Roles
roles:
    ## Admin Roles
    - accountadmin:
        warehouses:
            - analyst_xs
        member_of:
            - sysadmin

    - securityadmin:
        warehouses:
            - analyst_xs
        member_of:
            - sysadmin

    - permission_bot:
        warehouses:
            - analyst_xs
        member_of:
            - securityadmin

    - sysadmin:
        warehouses:
            - analyst_xs
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                write:
                    - raw
                    - analytics
            schemas:
                read:
                    - raw.*
                    - analytics.*
                write:
                    - raw.*
                    - analytics.*
            tables:
                read:
                    - raw.*.*
                    - analytics.*.*
                write:
                    - raw.*.*
                    - analytics.*.*

    ## Regular Roles
    - loader:
        warehouses:
            - stitch
        owns:
            schemas:
                - raw.*
            tables:
                - raw.*.*
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                write:
                    - raw
                    - analytics
            schemas:
                read:
                    - raw.*
                    - analytics.*
                write:
                    - raw.*
                    - analytics.*
            tables:
                read:
                    - raw.*.*
                    - analytics.*.*
                write:
                    - raw.*.*
                    - analytics.*.*

    - reporter:
        warehouses:
            - analyst_xs
        member_of:
            - reporting
        privileges:
            databases:
                read:
                    - analytics
                    - snowflake
            schemas:
                read:
                    - analytics.*
                    - snowflake.account_usage
            tables:
                read:
                    - analytics.*.*
                    - snowflake.account_usage.*

    - transformer: # For automated jobs
        warehouses:
            - analyst_xs
        owns:
            schemas:
                - analytics.*
            tables:
                - analytics.*.*
        privileges:
            databases:
                read:
                    - raw
                    - analytics
                write:
                    - analytics
            schemas:
                read:
                    - raw.*
                    - analtics.*
                write:
                    - analytics.*
            tables:
                read:
                    - raw.*.*
                    - analytics.*.*
                write:
                    - analytics.*.*

    # Object Roles

    # User Roles
    - adovenmuehle:
        warehouses:
            - analyst_xs

    - rachel:
        warehouses:
            - analyst_xs

    - airflow:
        warehouses:
            - loading
            - transforming_xs

    - schiff:
        warehouses:
            - reporting

    - stitch:
        warehouses:
            - stitch
    

# Users
users:
    - adovenmuehle:
        can_login: yes
        member_of:
            - accountadmin
            - securityadmin

    - rachel:
        can_login: yes
        member_of:
            - accountadmin
            - securityadmin

    - schiff:
        can_login: yes
        member_of:
            - accountadmin
            - securityadmin

    - airflow:
        can_login: yes
        member_of:
            - airflow
            - loader
            - reporter
            - sysadmin
            - transformer

    - stitch:
        can_login: yes
        member_of:
            - stitch
            - loader

    - permission_bot:
        can_login: yes
        member_of:
            - permission_bot
            - securityadmin

    - looker:
        can_login: yes
        member_of:
            - reporting

# Warehouses
warehouses:
    - analyst_xs:
        size: x-small

    - reporting:
        size: x-small

    - stitch:
        size: x-small
